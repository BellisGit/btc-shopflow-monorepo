# 视频转码命令

## 将视频转码为 HTML5 兼容的 MP4 格式

### 推荐命令（平衡质量和大小）

```bash
ffmpeg -i "automation_area.mp4" \
  -c:v libx264 \
  -preset medium \
  -crf 23 \
  -profile:v high \
  -level 4.0 \
  -pix_fmt yuv420p \
  -c:a aac \
  -b:a 128k \
  -movflags +faststart \
  "automation_area_web.mp4"
```

### 更小文件（质量稍低，适合网络播放）

```bash
ffmpeg -i "automation_area.mp4" \
  -c:v libx264 \
  -preset slow \
  -crf 28 \
  -profile:v high \
  -level 4.0 \
  -pix_fmt yuv420p \
  -vf "scale=1920:-2" \
  -c:a aac \
  -b:a 96k \
  -movflags +faststart \
  "automation_area_web.mp4"
```

### 参数说明

- `-c:v libx264`: 使用 H.264 视频编码（最广泛支持）
- `-preset medium`: 编码速度（ultrafast/superfast/veryfast/faster/fast/medium/slow/slower/veryslow）
- `-crf 23`: 质量参数（18-28，数值越大文件越小，23 是推荐值）
- `-profile:v high`: H.264 配置文件（baseline/main/high）
- `-level 4.0`: H.264 级别（确保兼容性）
- `-pix_fmt yuv420p`: 像素格式（确保兼容性）
- `-c:a aac`: 使用 AAC 音频编码
- `-b:a 128k`: 音频比特率
- `-movflags +faststart`: 优化网络播放（将元数据移到文件开头）
- `-vf "scale=1920:-2"`: 限制最大宽度为 1920px（可选）

### 检查视频编码信息

```bash
ffprobe -v error -select_streams v:0 -show_entries stream=codec_name,codec_long_name,width,height,bit_rate -of default=noprint_wrappers=1 "automation_area.mp4"
```

### 如果原视频已经是 H.264，只需重新封装

```bash
ffmpeg -i "automation_area.mp4" \
  -c:v copy \
  -c:a copy \
  -movflags +faststart \
  "automation_area_web.mp4"
```

