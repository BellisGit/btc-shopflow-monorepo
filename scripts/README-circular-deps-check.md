# å¾ªç¯ä¾èµ–æ£€æµ‹å·¥å…·

## ç®€ä»‹

è¿™ä¸ªå·¥å…·å¯ä»¥åœ¨å¯åŠ¨å¼€å‘æœåŠ¡å™¨æˆ–æ„å»ºä¹‹å‰æ£€æµ‹é¡¹ç›®ä¸­çš„å¾ªç¯ä¾èµ–é—®é¢˜ï¼Œé¿å…åœ¨è¿è¡Œæ—¶æ‰å‘ç°é”™è¯¯ã€‚

## ä½¿ç”¨æ–¹æ³•

### æ‰‹åŠ¨æ£€æµ‹

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```bash
pnpm check:circular
```

### è‡ªåŠ¨æ£€æµ‹

å¾ªç¯ä¾èµ–æ£€æµ‹å·²é›†æˆåˆ°ä»¥ä¸‹å‘½ä»¤ä¸­ï¼š

- `pnpm dev:system` - å¯åŠ¨å¼€å‘æœåŠ¡å™¨å‰è‡ªåŠ¨æ£€æµ‹
- `pnpm build:system` - æ„å»ºå‰è‡ªåŠ¨æ£€æµ‹
- `pnpm build:all` - æ„å»ºæ‰€æœ‰åº”ç”¨å‰è‡ªåŠ¨æ£€æµ‹

å¦‚æœæ£€æµ‹åˆ°å¾ªç¯ä¾èµ–ï¼Œå‘½ä»¤ä¼šå¤±è´¥å¹¶æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ã€‚

## æ£€æµ‹èŒƒå›´

å·¥å…·ä¼šæ£€æµ‹ä»¥ä¸‹ç›®å½•ï¼š

**åº”ç”¨ç›®å½•ï¼š**
- `apps/system-app/src`
- `apps/admin-app/src`
- `apps/logistics-app/src`
- `apps/finance-app/src`
- `apps/engineering-app/src`
- `apps/quality-app/src`
- `apps/production-app/src`

**åŒ…ç›®å½•ï¼š**
- `packages/shared-core/src`
- `packages/shared-components/src`
- `packages/shared-utils/src`

## è¾“å‡ºç¤ºä¾‹

### æœªå‘ç°å¾ªç¯ä¾èµ–
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” å¼€å§‹æ£€æµ‹å¾ªç¯ä¾èµ–...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” æ£€æŸ¥ system-app/src (apps/system-app/src)...
âœ… system-app/src æœªå‘ç°å¾ªç¯ä¾èµ–

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š æ£€æµ‹æ€»ç»“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… æ‰€æœ‰ç›®å½•å‡æœªå‘ç°å¾ªç¯ä¾èµ–ï¼
```

### å‘ç°å¾ªç¯ä¾èµ–
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” å¼€å§‹æ£€æµ‹å¾ªç¯ä¾èµ–...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” æ£€æŸ¥ system-app/src (apps/system-app/src)...
âŒ system-app/src å‘ç°å¾ªç¯ä¾èµ–:
Circular dependency detected!
â””â”€ src/plugins/user-setting/composables/useSettingsHandlers.ts
   â””â”€ src/plugins/user-setting/composables/useSettingsState.ts
      â””â”€ src/plugins/user-setting/composables/useSettingsHandlers.ts

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š æ£€æµ‹æ€»ç»“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ å‘ç° 1 ä¸ªç›®å½•å­˜åœ¨å¾ªç¯ä¾èµ–:

  â€¢ system-app/src
    - Circular dependency detected!
      â””â”€ src/plugins/user-setting/composables/useSettingsHandlers.ts
         â””â”€ src/plugins/user-setting/composables/useSettingsState.ts
            â””â”€ src/plugins/user-setting/composables/useSettingsHandlers.ts

ğŸ’¡ æç¤º: è¯·ä¿®å¤ä¸Šè¿°å¾ªç¯ä¾èµ–åå†ç»§ç»­å¼€å‘
```

## ä¿®å¤å¾ªç¯ä¾èµ–çš„å¸¸è§æ–¹æ³•

1. **ä½¿ç”¨åŠ¨æ€å¯¼å…¥**ï¼šå°†é™æ€ `import` æ”¹ä¸ºåŠ¨æ€ `import()`
2. **å»¶è¿Ÿåˆå§‹åŒ–**ï¼šå°†åˆå§‹åŒ–é€»è¾‘ç§»åˆ°å‡½æ•°å†…éƒ¨ï¼Œè€Œä¸æ˜¯æ¨¡å—é¡¶å±‚
3. **æå–å…¬å…±ä¾èµ–**ï¼šå°†å…±åŒçš„ä¾èµ–æå–åˆ°ç‹¬ç«‹çš„æ¨¡å—ä¸­
4. **ä½¿ç”¨ä¾èµ–æ³¨å…¥**ï¼šé€šè¿‡å‡½æ•°å‚æ•°ä¼ é€’ä¾èµ–ï¼Œè€Œä¸æ˜¯ç›´æ¥å¯¼å…¥

## æŠ€æœ¯ç»†èŠ‚

å·¥å…·ä½¿ç”¨ [madge](https://github.com/pahen/madge) æ¥åˆ†ææ¨¡å—ä¾èµ–å…³ç³»ã€‚madge æ”¯æŒ TypeScriptã€Vue å’Œ JavaScript æ–‡ä»¶ã€‚

## æ•…éšœæ’é™¤

### madge æœªå®‰è£…

å¦‚æœé¦–æ¬¡è¿è¡Œæç¤º madge æœªå®‰è£…ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨å°è¯•å®‰è£…ã€‚å¦‚æœè‡ªåŠ¨å®‰è£…å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å®‰è£…ï¼š

```bash
pnpm add -D -w madge
```

### è¯¯æŠ¥

æœ‰æ—¶å·¥å…·å¯èƒ½ä¼šæŠ¥å‘Šä¸€äº›è¯¯æŠ¥ã€‚å¦‚æœç¡®å®šä¸æ˜¯çœŸæ­£çš„å¾ªç¯ä¾èµ–ï¼Œå¯ä»¥ï¼š

1. æ£€æŸ¥æ˜¯å¦æ˜¯ TypeScript ç±»å‹å¯¼å…¥å¯¼è‡´çš„ï¼ˆé€šå¸¸ä¸ä¼šé€ æˆè¿è¡Œæ—¶é—®é¢˜ï¼‰
2. æ£€æŸ¥æ˜¯å¦æ˜¯åŠ¨æ€å¯¼å…¥çš„é™æ€åˆ†æè¯¯åˆ¤
3. åœ¨è„šæœ¬ä¸­æ·»åŠ æ’é™¤è§„åˆ™

