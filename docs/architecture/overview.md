# 架构总览

## 系统架构

BTC Shopflow 是一个基于微前端架构的 Monorepo 项目，采用主应用 + 多子应用 + 共享包的架构模式。

## 核心架构组件

### 1. 微前端架构

采用 Qiankun 微前端框架，实现：
- **主应用（main-app）**: 提供全局布局、路由协调、状态管理
- **子应用**: 独立开发和部署的业务应用
- **共享包**: 公共组件、工具、配置

### 架构图

```
┌─────────────────────────────────────────┐
│          Main App (主应用)              │
│  - 全局布局                             │
│  - 路由协调                             │
│  - 状态管理                             │
└─────────────────────────────────────────┘
           │
           ├──────────────┬──────────────┐
           │              │              │
    ┌──────▼──────┐ ┌─────▼─────┐ ┌─────▼─────┐
    │  Admin App  │ │System App │ │Logistics  │
    │  (子应用)    │ │ (子应用)   │ │  App     │
    └─────────────┘ └───────────┘ └───────────┘
           │              │              │
           └──────────────┴──────────────┘
                      │
           ┌───────────▼───────────┐
           │    Shared Packages    │
           │  - shared-core        │
           │  - shared-components  │
           │  - design-tokens       │
           └───────────────────────┘
```

### 2. 模块系统

每个应用采用模块化架构：
- **自动路由发现**: 从模块 `config.ts` 自动提取路由
- **模块配置**: 统一的 `ModuleConfig` 类型
- **模块注册**: 通过 `PluginManager` 自动注册

### 3. 插件系统

可插拔的插件机制：
- **自动扫描**: 扫描 `plugins/` 目录
- **生命周期**: `install` 和 `onLoad` 钩子
- **组件注册**: 自动注册全局组件和指令

## 技术栈

### 前端框架
- **Vue 3**: Composition API
- **Vue Router**: 路由管理
- **Pinia**: 状态管理
- **Element Plus**: UI 组件库

### 构建工具
- **Vite**: 构建工具
- **pnpm**: 包管理器
- **TypeScript**: 类型系统

### 微前端
- **Qiankun**: 微前端框架
- **独立运行**: 支持独立开发和部署

## 目录结构

详见 [项目结构](../getting-started/project-structure.md)

## 核心概念

### 应用（App）
- **主应用**: 提供全局能力，协调子应用
- **子应用**: 独立业务应用，可独立运行

### 模块（Module）
- 业务功能单元
- 对应一级菜单路由
- 包含路由、视图、配置

### 插件（Plugin）
- 可插拔功能模块
- 提供全局能力（组件、指令、服务）
- 支持生命周期钩子

### 共享包（Package）
- 跨应用复用的代码
- 组件、工具、配置
- 版本独立管理

## 数据流

```
用户操作
    ↓
路由系统（Vue Router）
    ↓
模块视图组件
    ↓
Composables / Store
    ↓
API 服务
    ↓
后端服务
```

## 状态管理

- **全局状态**: 主应用管理（用户信息、菜单等）
- **应用状态**: 各子应用独立管理
- **模块状态**: 通过 Composables 管理

## 路由系统

- **自动发现**: 从模块配置自动提取路由
- **路由注册**: 应用启动时自动注册
- **路由同步**: 微前端环境下路由同步

## 相关文档

- [微前端架构](./micro-frontend.md) - 微前端详细说明
- [模块系统](./module-system.md) - 模块系统详解
- [插件系统](./plugin-system.md) - 插件系统说明
- [认证授权](./auth.md) - 认证架构
