name: Build and Deploy All Apps

on:
  repository_dispatch:
    types: [build-deploy-all-apps]
  workflow_dispatch:

permissions:
  contents: read
  packages: write
  actions: write

jobs:
  trigger-system:
    name: Trigger System App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-system-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-system-app.yml',
              ref: 'master',
            });

  trigger-admin:
    name: Trigger Admin App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-admin-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-admin-app.yml',
              ref: 'master',
            });

  trigger-logistics:
    name: Trigger Logistics App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-logistics-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-logistics-app.yml',
              ref: 'master',
            });

  trigger-production:
    name: Trigger Production App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-production-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-production-app.yml',
              ref: 'master',
            });

  trigger-quality:
    name: Trigger Quality App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-quality-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-quality-app.yml',
              ref: 'master',
            });

  trigger-engineering:
    name: Trigger Engineering App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-engineering-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-engineering-app.yml',
              ref: 'master',
            });

  trigger-finance:
    name: Trigger Finance App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-finance-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-finance-app.yml',
              ref: 'master',
            });

  trigger-mobile:
    name: Trigger Mobile App
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy-mobile-app workflow
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy-mobile-app.yml',
              ref: 'master',
            });
