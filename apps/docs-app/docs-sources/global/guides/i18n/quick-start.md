# å›½é™…åŒ–ä¼˜åŒ–å¿«é€Ÿå¼€å§‹æŒ‡å—

> 5 åˆ†é’Ÿäº†è§£å¦‚ä½•ä¼˜åŒ–é¡¹ç›®çš„å›½é™…åŒ–é…ç½®

## ğŸ“– èƒŒæ™¯

å½“å‰é¡¹ç›®çš„å›½é™…åŒ–é…ç½®å­˜åœ¨ä»¥ä¸‹é—®é¢˜:
- âŒ **æ ¼å¼æ··ä¹±**: JSONã€TS æ‰å¹³æ ¼å¼ã€TS åµŒå¥—æ ¼å¼æ··ç”¨
- âŒ **é‡å¤å†…å®¹**: `common.button.*`ã€`crud.*` ç­‰åœ¨å¤šä¸ªåº”ç”¨é‡å¤å®šä¹‰
- âŒ **ç»´æŠ¤å›°éš¾**: 94+ ä¸ªé…ç½®æ–‡ä»¶åˆ†æ•£åœ¨å„å¤„
- âŒ **æ€§èƒ½å¼€é”€**: å¤æ‚çš„è½¬æ¢é€»è¾‘ (626 è¡Œä»£ç )

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

- âœ… ç»Ÿä¸€ä½¿ç”¨ TypeScript åµŒå¥—æ ¼å¼
- âœ… æå–å…±äº«ç¿»è¯‘,æ¶ˆé™¤é‡å¤
- âœ… ç®€åŒ–æ–‡ä»¶ç»“æ„å’ŒåŠ è½½é€»è¾‘
- âœ… æå‡å¼€å‘ä½“éªŒå’Œä»£ç è´¨é‡

## ğŸš€ å¿«é€Ÿè¯„ä¼°

### 1. è¿è¡Œåˆ†æè„šæœ¬

```bash
# åˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•
cd btc-shopflow-monorepo

# å®‰è£…ä¾èµ– (å¦‚æœè¿˜æ²¡å®‰è£…)
pnpm add -D glob

# æ£€æŸ¥ç¿»è¯‘å®Œæ•´æ€§
node scripts/i18n/check-completeness.mjs

# æŸ¥æ‰¾é‡å¤ç¿»è¯‘
node scripts/i18n/find-duplicates.mjs
```

### 2. æŸ¥çœ‹æŠ¥å‘Š

è„šæœ¬ä¼šç”Ÿæˆä¸¤ä¸ªæŠ¥å‘Š:
- ç»ˆç«¯è¾“å‡º: ç›´è§‚çš„ç»Ÿè®¡å’Œé—®é¢˜åˆ—è¡¨
- `i18n-duplicates-report.json`: è¯¦ç»†çš„é‡å¤åˆ†æ

### 3. é˜…è¯»è¯¦ç»†æ–¹æ¡ˆ

æŸ¥çœ‹å®Œæ•´çš„åˆ†æå’Œä¼˜åŒ–æ–¹æ¡ˆ:
```bash
code docs/i18n-optimization-analysis.md
```

## ğŸ“‹ æ¨èçš„å®æ–½é¡ºåº

### é˜¶æ®µ 1: äº†è§£ç°çŠ¶ (1å°æ—¶)

1. **è¿è¡Œåˆ†æè„šæœ¬**
   ```bash
   node scripts/i18n/check-completeness.mjs > completeness-report.txt
   node scripts/i18n/find-duplicates.mjs > duplicates-report.txt
   ```

2. **æŸ¥çœ‹æŠ¥å‘Š**
   - æœ‰å¤šå°‘ç¿»è¯‘ç¼ºå¤±?
   - æœ‰å¤šå°‘é‡å¤?
   - å“ªäº›æ˜¯é«˜ä¼˜å…ˆçº§çš„ä¼˜åŒ–ç‚¹?

3. **è¯„ä¼°å·¥ä½œé‡**
   - æ ¹æ®æŠ¥å‘Šä¼°ç®—éœ€è¦çš„æ—¶é—´
   - ç¡®å®šæ˜¯å¦éœ€è¦å›¢é˜Ÿåä½œ

### é˜¶æ®µ 2: å°èŒƒå›´è¯•ç‚¹ (2-3å¤©)

é€‰æ‹©ä¸€ä¸ªåº”ç”¨ (å»ºè®®ä»ç®€å•çš„å¼€å§‹) è¿›è¡Œè¯•ç‚¹:

1. **åˆ›å»ºæ–°çš„ç›®å½•ç»“æ„**
   ```bash
   mkdir -p locales/shared
   mkdir -p locales/domains
   ```

2. **æå–é€šç”¨ç¿»è¯‘**
   ```bash
   # åˆ›å»ºå…±äº«ç¿»è¯‘æ–‡ä»¶
   code locales/shared/common.ts
   ```

   ```typescript
   // locales/shared/common.ts
   export const common = {
     'zh-CN': {
       button: {
         save: 'ä¿å­˜',
         cancel: 'å–æ¶ˆ',
         // ...
       }
     },
     'en-US': {
       button: {
         save: 'Save',
         cancel: 'Cancel',
         // ...
       }
     }
   };
   ```

3. **è½¬æ¢ä¸€ä¸ªåº”ç”¨çš„é…ç½®**
   ```bash
   # è½¬æ¢ logistics-app (è¾ƒç®€å•)
   node scripts/i18n/migrate-flat-to-nested.mjs dir \
     apps/logistics-app/src/locales \
     temp/logistics
   ```

4. **æ›´æ–°åº”ç”¨çš„ i18n é…ç½®**
   ```typescript
   // apps/logistics-app/src/i18n/index.ts
   import { common } from '@workspace/locales/shared/common';
   
   const messages = {
     'zh-CN': {
       ...common['zh-CN'],
       // åº”ç”¨ç‰¹å®šç¿»è¯‘
     }
   };
   ```

5. **æµ‹è¯•éªŒè¯**
   - å¯åŠ¨åº”ç”¨
   - åˆ‡æ¢è¯­è¨€
   - æ£€æŸ¥åŠŸèƒ½æ­£å¸¸

### é˜¶æ®µ 3: å…¨é¢æ¨å¹¿ (1-2å‘¨)

è¯•ç‚¹æˆåŠŸå,æ¨å¹¿åˆ°å…¶ä»–åº”ç”¨:

1. **ä¾æ¬¡è¿ç§»å…¶ä»–åº”ç”¨**
   - system-app
   - admin-app
   - quality-app
   - production-app
   - ...

2. **æ¸…ç†å†—ä½™æ–‡ä»¶**
   ```bash
   # åˆ é™¤æ—§çš„ JSON æ–‡ä»¶ (ç¡®ä¿å·²è¿ç§»)
   find apps/*/src/locales -name "*.json" -delete
   ```

3. **ç®€åŒ–åŠ è½½é€»è¾‘**
   - åˆ é™¤å¤æ‚çš„ flatten/unflatten è½¬æ¢
   - ä½¿ç”¨ç®€å•çš„æ·±åº¦åˆå¹¶

### é˜¶æ®µ 4: ç»´æŠ¤ä¼˜åŒ– (æŒç»­)

1. **æ·»åŠ  CI æ£€æŸ¥**
   ```yaml
   # .github/workflows/i18n-check.yml
   name: I18n Check
   on: [pull_request]
   jobs:
     check:
       runs-on: ubuntu-latest
       steps:
         - uses: actions/checkout@v3
         - run: node scripts/i18n/check-completeness.mjs
   ```

2. **æ›´æ–°å¼€å‘æ–‡æ¡£**
   - ç¼–å†™æ–°çš„å›½é™…åŒ–ä½¿ç”¨æŒ‡å—
   - åŸ¹è®­å›¢é˜Ÿæˆå‘˜

3. **å®šæœŸå®¡æŸ¥**
   - æ¯æœˆè¿è¡Œä¸€æ¬¡é‡å¤æ£€æµ‹
   - åŠæ—¶æ¸…ç†æ–°çš„é‡å¤

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

```bash
# æ£€æŸ¥å®Œæ•´æ€§
npm run i18n:check
# æˆ–
node scripts/i18n/check-completeness.mjs

# æŸ¥æ‰¾é‡å¤
npm run i18n:duplicates
# æˆ–
node scripts/i18n/find-duplicates.mjs

# è¿ç§»å•ä¸ªæ–‡ä»¶
npm run i18n:migrate -- file <input> <output>
# æˆ–
node scripts/i18n/migrate-flat-to-nested.mjs file <input> <output>

# è¿ç§»ç›®å½•
npm run i18n:migrate -- dir <input-dir> <output-dir>
# æˆ–
node scripts/i18n/migrate-flat-to-nested.mjs dir <input-dir> <output-dir>
```

## ğŸ“ é…ç½® package.json

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `package.json` æ·»åŠ ä»¥ä¸‹è„šæœ¬:

```json
{
  "scripts": {
    "i18n:check": "node scripts/i18n/check-completeness.mjs",
    "i18n:duplicates": "node scripts/i18n/find-duplicates.mjs",
    "i18n:migrate": "node scripts/i18n/migrate-flat-to-nested.mjs"
  }
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **ä½¿ç”¨åµŒå¥—æ ¼å¼**
   ```typescript
   // âœ… å¥½
   {
     common: {
       button: {
         save: 'ä¿å­˜'
       }
     }
   }
   
   // âŒ ä¸å¥½
   {
     'common.button.save': 'ä¿å­˜'
   }
   ```

2. **æå–é€šç”¨ç¿»è¯‘**
   ```typescript
   // âœ… å¥½: åœ¨å…±äº«ç›®å½•å®šä¹‰ä¸€æ¬¡
   // locales/shared/common.ts
   
   // âŒ ä¸å¥½: åœ¨æ¯ä¸ªåº”ç”¨é‡å¤å®šä¹‰
   ```

3. **è¯­ä¹‰åŒ–å‘½å**
   ```typescript
   // âœ… å¥½
   'warehouse.material.fields.material_code'
   
   // âŒ ä¸å¥½
   'wh.mat.f.mc'
   ```

4. **ä¿æŒå±‚çº§ä¸€è‡´**
   ```typescript
   // âœ… å¥½: 2-4 å±‚
   'common.button.save'              // 3å±‚
   'warehouse.material.title'        // 3å±‚
   'warehouse.material.fields.code'  // 4å±‚
   
   // âŒ ä¸å¥½: è¿‡æ·±æˆ–è¿‡æµ…
   'save'                            // 1å±‚,å¤ªé€šç”¨
   'warehouse.material.fields.properties.code.display'  // 6å±‚,å¤ªæ·±
   ```

### âŒ é¿å…çš„åšæ³•

1. **ä¸è¦æ··ç”¨æ ¼å¼**
2. **ä¸è¦é‡å¤å®šä¹‰é€šç”¨ç¿»è¯‘**
3. **ä¸è¦ä½¿ç”¨è¿‡é•¿æˆ–è¿‡çŸ­çš„ key**
4. **ä¸è¦å¿˜è®°æ·»åŠ è‹±æ–‡ç¿»è¯‘**

## ğŸ” å¸¸è§é—®é¢˜

### Q: éœ€è¦å¤šé•¿æ—¶é—´?

A: å–å†³äºé¡¹ç›®è§„æ¨¡:
- å°å‹é¡¹ç›® (1-2ä¸ªåº”ç”¨): 1-2å¤©
- ä¸­å‹é¡¹ç›® (3-5ä¸ªåº”ç”¨): 3-5å¤©
- å¤§å‹é¡¹ç›® (6+ä¸ªåº”ç”¨): 1-2å‘¨

### Q: ä¼šå½±å“ç°æœ‰åŠŸèƒ½å—?

A: å¦‚æœæŒ‰ç…§æ­¥éª¤æ­£ç¡®è¿ç§»,ä¸ä¼šå½±å“åŠŸèƒ½ã€‚å»ºè®®:
- å…ˆåœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•
- åˆ›å»ºç‹¬ç«‹åˆ†æ”¯
- é€æ­¥è¿ç§»,ä¸è¦ä¸€æ¬¡æ€§å…¨æ”¹

### Q: å¦‚ä½•å¤„ç†ç‰¹æ®Šå­—ç¬¦?

A: TypeScript åµŒå¥—æ ¼å¼è‡ªåŠ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦:
```typescript
{
  field: {
    'has-dash': 'å¸¦æ¨ªçº¿çš„key',
    'has space': 'å¸¦ç©ºæ ¼çš„key',
    'æ•°å­—123': 'å¸¦æ•°å­—çš„key'
  }
}
```

### Q: å¦‚ä½•å¤„ç†å˜é‡æ’å€¼?

A: Vue I18n æ”¯æŒå ä½ç¬¦:
```typescript
{
  message: {
    welcome: 'æ¬¢è¿, {name}!',
    count: 'å…±æœ‰ {count} æ¡è®°å½•'
  }
}

// ä½¿ç”¨
$t('message.welcome', { name: 'å¼ ä¸‰' })
$t('message.count', { count: 10 })
```

### Q: æ€§èƒ½ä¼šå—å½±å“å—?

A: ä¼˜åŒ–åæ€§èƒ½ä¼šæå‡:
- âœ… å‡å°‘æ–‡ä»¶æ•°é‡ (-68%)
- âœ… ç®€åŒ–åŠ è½½é€»è¾‘ (-76% ä»£ç )
- âœ… å‡å°‘å†…å­˜å ç”¨
- âœ… é¢„è®¡åŠ è½½é€Ÿåº¦æå‡ 20-30%

## ğŸ“ è·å–å¸®åŠ©

- ğŸ“– å®Œæ•´æ–‡æ¡£: `docs/i18n-optimization-analysis.md`
- ğŸ› ï¸ è„šæœ¬æ–‡æ¡£: `scripts/i18n/README.md`
- ğŸ’¬ æŠ€æœ¯æ”¯æŒ: [è”ç³»å›¢é˜Ÿ]

## ğŸ“… æ—¶é—´çº¿ç¤ºä¾‹

å‡è®¾ä¸€ä¸ªä¸­å‹é¡¹ç›® (5ä¸ªåº”ç”¨):

| æ—¶é—´ | ä»»åŠ¡ | è´Ÿè´£äºº |
|------|------|--------|
| Day 1 | è¿è¡Œåˆ†æ,è¯„ä¼°ç°çŠ¶ | æŠ€æœ¯è´Ÿè´£äºº |
| Day 2-3 | åˆ›å»ºå…±äº«ç¿»è¯‘ç›®å½•,æå–é€šç”¨ç¿»è¯‘ | å‰ç«¯å›¢é˜Ÿ |
| Day 4 | è¯•ç‚¹è¿ç§» logistics-app | å¼€å‘è€… A |
| Day 5 | éªŒè¯è¯•ç‚¹,è°ƒæ•´æ–¹æ¡ˆ | å›¢é˜Ÿè¯„å®¡ |
| Day 6-7 | è¿ç§» system-app, admin-app | å¼€å‘è€… B, C |
| Day 8-9 | è¿ç§»å‰©ä½™åº”ç”¨ | å‰ç«¯å›¢é˜Ÿ |
| Day 10 | æ¸…ç†å†—ä½™æ–‡ä»¶,ç®€åŒ–é€»è¾‘ | æŠ€æœ¯è´Ÿè´£äºº |
| Day 11 | å…¨é¢æµ‹è¯• | æµ‹è¯•å›¢é˜Ÿ |
| Day 12 | ä»£ç å®¡æŸ¥,åˆå¹¶ä¸»åˆ†æ”¯ | å›¢é˜Ÿ |

## âœ… æ£€æŸ¥æ¸…å•

è¿ç§»å®Œæˆå,ç¡®ä¿:

- [ ] æ‰€æœ‰åº”ç”¨èƒ½æ­£å¸¸å¯åŠ¨
- [ ] è¯­è¨€åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- [ ] æ‰€æœ‰é¡µé¢ç¿»è¯‘æ­£ç¡®
- [ ] CRUD æ“ä½œåŠŸèƒ½æ­£å¸¸
- [ ] æ²¡æœ‰æ§åˆ¶å°é”™è¯¯
- [ ] å®Œæ•´æ€§æ£€æŸ¥é€šè¿‡ (100%)
- [ ] æ²¡æœ‰é‡å¤ç¿»è¯‘
- [ ] CI æ£€æŸ¥é€šè¿‡
- [ ] æ–‡æ¡£å·²æ›´æ–°
- [ ] å›¢é˜Ÿå·²åŸ¹è®­

---

**å‡†å¤‡å¥½äº†å—? è®©æˆ‘ä»¬å¼€å§‹ä¼˜åŒ–å§! ğŸš€**

ä»è¿è¡Œç¬¬ä¸€ä¸ªåˆ†æè„šæœ¬å¼€å§‹:
```bash
node scripts/i18n/find-duplicates.mjs
```
