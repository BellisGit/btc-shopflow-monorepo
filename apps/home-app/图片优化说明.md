# 图片优化说明

## 已实现的优化

### 1. WebP 格式支持
- ✅ 自动检测浏览器 WebP 支持
- ✅ 使用 `<picture>` 标签提供 WebP 和原始格式降级
- ✅ 支持所有图片组件（产品图片、新闻动态图片）

### 2. 懒加载优化
- ✅ 产品图片：`loading="lazy"`
- ✅ 新闻动态图片：`loading="lazy"`
- ✅ 首屏封面图：`loading="eager"`（优先加载）

### 3. 解码优化
- ✅ 非关键图片：`decoding="async"`（异步解码，不阻塞渲染）
- ✅ 关键图片：`decoding="sync"`（同步解码，优先处理）

### 4. CDN 加速
- ✅ 生产环境使用 CDN：`https://all.bellis.com.cn`
- ✅ 开发环境使用本地文件

## 需要手动优化的步骤

### 1. 图片压缩

#### 使用在线工具压缩：
- [TinyPNG](https://tinypng.com/) - PNG/JPEG 压缩
- [Squoosh](https://squoosh.app/) - 多种格式压缩和转换
- [ImageOptim](https://imageoptim.com/) - Mac 桌面工具

#### 压缩建议：
- **新闻动态图片**：压缩到 200KB 以下
- **产品图片**：压缩到 150KB 以下
- **首屏封面图**：压缩到 100KB 以下

### 2. 转换为 WebP 格式

#### 使用工具转换：
```bash
# 使用 cwebp（需要安装 WebP 工具）
cwebp -q 85 input.jpg -o output.webp

# 或使用在线工具
# https://squoosh.app/
# https://convertio.co/zh/webp-converter/
```

#### 文件命名规则：
- 原始文件：`1.jpg`
- WebP 文件：`1.webp`
- 放在 CDN 的同一目录下

### 3. CDN 配置建议

#### 启用 CDN 图片处理（如果支持）：
- 阿里云 OSS：`?x-oss-process=image/resize,w_800/quality,q_85/format,webp`
- 腾讯云 COS：`?imageMogr2/thumbnail/800x/format/webp/quality/85`
- 其他 CDN：根据服务商文档配置

#### 缓存策略：
- 设置长期缓存（1年）：`Cache-Control: max-age=31536000`
- 使用版本号或哈希：`?v=1.0` 或 `?hash=abc123`

### 4. 响应式图片（可选）

如果需要更精细的控制，可以使用 `srcset`：

```html
<img
  src="image.jpg"
  srcset="
    image-400w.webp 400w,
    image-800w.webp 800w,
    image-1200w.webp 1200w
  "
  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
  alt="描述"
/>
```

## 性能监控

### 检查图片加载性能：
1. 打开浏览器开发者工具
2. 进入 Network 标签
3. 筛选 Images
4. 查看：
   - 文件大小
   - 加载时间
   - 是否使用了 WebP

### 优化目标：
- 首屏图片总大小 < 500KB
- 单张图片 < 200KB
- LCP（Largest Contentful Paint）< 2.5s

## 自动化脚本建议

可以创建脚本自动压缩和转换图片：

```bash
# 示例：批量压缩和转换
for file in *.jpg; do
  # 压缩 JPEG
  jpegoptim --max=85 "$file"
  
  # 转换为 WebP
  cwebp -q 85 "$file" -o "${file%.jpg}.webp"
done
```

## 注意事项

1. **保持原始文件**：压缩前备份原始文件
2. **测试降级**：确保不支持 WebP 的浏览器能正常显示
3. **CDN 同步**：确保 WebP 文件已上传到 CDN
4. **监控效果**：使用 Lighthouse 或 WebPageTest 测试性能提升

