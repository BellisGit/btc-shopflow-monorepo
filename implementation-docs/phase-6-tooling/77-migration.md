# 42.6 - è€é¡¹ç›®è¿ç§»æŒ‡å—

> **é˜¶æ®µ**: Phase 6 | **æ—¶é—´**: 4å°æ—¶ | **å‰ç½®**: 42.5

## ğŸ¯ ä»»åŠ¡ç›®æ ‡

æä¾›è€é¡¹ç›®è¿ç§»åˆ°å¾®å‰ç«¯æ¶æ„çš„å®Œæ•´æŒ‡å—ã€‚

## ğŸ“‹ è¿ç§»ç­–ç•¥

### ç­–ç•¥ä¸€ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: å¤§å‹é¡¹ç›®ï¼Œä¸èƒ½åœæœè¿ç§»

**æ­¥éª¤**:
```
1. æ­å»ºå¾®å‰ç«¯ä¸»åº”ç”¨
2. è€é¡¹ç›®ä½œä¸ºç¬¬ä¸€ä¸ªå­åº”ç”¨æ¥å…¥
3. æ–°åŠŸèƒ½åœ¨æ–°å­åº”ç”¨ä¸­å¼€å‘
4. é€æ­¥æ‹†åˆ†è€é¡¹ç›®æ¨¡å—åˆ°æ–°å­åº”ç”¨
5. æœ€ç»ˆä¸‹çº¿è€é¡¹ç›®
```

**æ—¶é—´å‘¨æœŸ**: 3-6ä¸ªæœˆ

### ç­–ç•¥äºŒï¼šå¹¶è¡Œå¼€å‘ï¼ˆå¿«é€Ÿï¼‰

**é€‚ç”¨åœºæ™¯**: ä¸­å°å‹é¡¹ç›®ï¼Œå¯ä»¥é‡æ„

**æ­¥éª¤**:
```
1. åŒæ—¶æ­å»ºæ–°æ¶æ„å’Œè¿ç§»ä»£ç 
2. æ–°è€ç³»ç»Ÿå¹¶è¡Œè¿è¡Œ
3. æ•°æ®åŒæ­¥æˆ–å…±äº«
4. åˆ‡æ¢æµé‡åˆ°æ–°ç³»ç»Ÿ
5. ä¸‹çº¿è€ç³»ç»Ÿ
```

**æ—¶é—´å‘¨æœŸ**: 1-2ä¸ªæœˆ

## ğŸ“‹ è¿ç§»æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šè¯„ä¼°å’Œè§„åˆ’ï¼ˆ1å‘¨ï¼‰

**è¯„ä¼°æ¸…å•**:
```markdown
- [ ] é¡¹ç›®è§„æ¨¡ï¼ˆä»£ç é‡ã€é¡µé¢æ•°ï¼‰
- [ ] æŠ€æœ¯æ ˆï¼ˆVue ç‰ˆæœ¬ã€ä¾èµ–ï¼‰
- [ ] ä¸šåŠ¡æ¨¡å—åˆ’åˆ†
- [ ] æ•°æ®ä¾èµ–å…³ç³»
- [ ] å›¢é˜Ÿè§„æ¨¡å’ŒæŠ€èƒ½
- [ ] å¯æ¥å—çš„åœæœæ—¶é—´
```

**è¾“å‡º**:
- è¿ç§»æ–¹æ¡ˆæ–‡æ¡£
- æ¨¡å—åˆ’åˆ†æ–¹æ¡ˆ
- æ—¶é—´è®¡åˆ’è¡¨
- é£é™©è¯„ä¼°

### ç¬¬äºŒæ­¥ï¼šæ­å»ºä¸»åº”ç”¨ï¼ˆ1-2å‘¨ï¼‰

```bash
# 1. åˆ›å»º Monorepo
å‚è€ƒæ–‡æ¡£: 01-monorepo-init.md

# 2. æ­å»ºä¸»åº”ç”¨
å‚è€ƒæ–‡æ¡£: 16-24 (é˜¶æ®µä¸‰)

# 3. é…ç½® qiankun
å‚è€ƒæ–‡æ¡£: 17-qiankun-setup.md
```

### ç¬¬ä¸‰æ­¥ï¼šæ¥å…¥è€é¡¹ç›®ï¼ˆ1å‘¨ï¼‰

#### æ–¹å¼ä¸€ï¼šæ•´ä½“æ¥å…¥

**è€é¡¹ç›®æ”¹é€ **:
```typescript
// 1. å®‰è£… vite-plugin-qiankun
pnpm add -D vite-plugin-qiankun

// 2. æ·»åŠ  public-path.ts
if ((window as any).__POWERED_BY_QIANKUN__) {
  __webpack_public_path__ = (window as any).__INJECTED_PUBLIC_PATH_BY_QIANKUN__;
}

// 3. æ”¹é€  main.ts
import './public-path';
import { createApp } from 'vue';

let app: any = null;

function render(props: any = {}) {
  app = createApp(App);
  const container = props.container?.querySelector('#app') || '#app';
  app.mount(container);
}

// ç‹¬ç«‹è¿è¡Œ
if (!(window as any).__POWERED_BY_QIANKUN__) {
  render();
}

// å¯¼å‡ºç”Ÿå‘½å‘¨æœŸ
export async function bootstrap() {}
export async function mount(props: any) {
  render(props);
}
export async function unmount() {
  app?.unmount();
}

// 4. é…ç½® Vite
import qiankun from 'vite-plugin-qiankun';

export default {
  plugins: [
    qiankun('old-app', { useDevMode: true }),
  ],
};
```

**ä¸»åº”ç”¨æ³¨å†Œ**:
```typescript
// micro-apps.config.ts
{
  name: 'old-app',
  entry: 'http://localhost:5001',
  container: '#subapp-container',
  activeRule: '/old',
}
```

#### æ–¹å¼äºŒï¼šæŒ‰æ¨¡å—æ‹†åˆ†

**æ­¥éª¤**:
```
1. è¯†åˆ«ç‹¬ç«‹æ¨¡å—ï¼ˆå¦‚ï¼šç”¨æˆ·ç®¡ç†ã€è®¢å•ç®¡ç†ï¼‰
2. å°†æ¨¡å—ä»£ç å¤åˆ¶åˆ°æ–°å­åº”ç”¨
3. æ”¹é€ ä¸º CRUD é…ç½®åŒ–ï¼ˆå¯é€‰ï¼‰
4. æµ‹è¯•åŠŸèƒ½
5. åˆ‡æ¢è·¯ç”±åˆ°æ–°æ¨¡å—
6. åˆ é™¤è€æ¨¡å—ä»£ç 
```

### ç¬¬å››æ­¥ï¼šæ•°æ®è¿ç§»ï¼ˆæŒç»­ï¼‰

**API å…¼å®¹**:
```typescript
// 1. ä¿æŒè€ API å…¼å®¹
// 2. æ–°åŠŸèƒ½ä½¿ç”¨æ–° API
// 3. é€æ­¥åºŸå¼ƒè€ API

// è¯·æ±‚é€‚é…å™¨
const request = axios.create({
  baseURL: isOldModule ? OLD_API : NEW_API,
});
```

**çŠ¶æ€å…±äº«**:
```typescript
// qiankun GlobalState åŒæ­¥
setGlobalState({
  user: oldApp.getUserInfo(),
  token: oldApp.getToken(),
});
```

### ç¬¬äº”æ­¥ï¼šåŠŸèƒ½æµ‹è¯•ï¼ˆæ¯ä¸ªæ¨¡å—1å‘¨ï¼‰

**æµ‹è¯•æ¸…å•**:
```markdown
- [ ] é¡µé¢æ¸²æŸ“æ­£å¸¸
- [ ] è·¯ç”±è·³è½¬æ­£å¸¸
- [ ] API è°ƒç”¨æ­£å¸¸
- [ ] æƒé™æ§åˆ¶æ­£å¸¸
- [ ] æ ·å¼æ— å†²çª
- [ ] æ€§èƒ½æ— æ˜æ˜¾ä¸‹é™
- [ ] æ— æ§åˆ¶å°é”™è¯¯
```

### ç¬¬å…­æ­¥ï¼šç°åº¦å‘å¸ƒï¼ˆ1å‘¨ï¼‰

**ç°åº¦ç­–ç•¥**:
```nginx
# Nginx é…ç½®ç°åº¦
location / {
    # 10% æµé‡åˆ°æ–°ç³»ç»Ÿ
    if ($random < 0.1) {
        proxy_pass http://new-system;
    }
    
    # 90% æµé‡åˆ°è€ç³»ç»Ÿ
    proxy_pass http://old-system;
}
```

**ç›‘æ§æŒ‡æ ‡**:
- é”™è¯¯ç‡
- å“åº”æ—¶é—´
- ç”¨æˆ·åé¦ˆ
- æ€§èƒ½æŒ‡æ ‡

### ç¬¬ä¸ƒæ­¥ï¼šå…¨é‡åˆ‡æ¢ï¼ˆ1å¤©ï¼‰

```bash
# 1. å¤‡ä»½æ•°æ®å’Œä»£ç 
# 2. æ›´æ–° Nginx é…ç½®æŒ‡å‘æ–°ç³»ç»Ÿ
# 3. ç›‘æ§é”™è¯¯å’Œæ€§èƒ½
# 4. å‡†å¤‡å›æ»šæ–¹æ¡ˆ
```

## âœ… è¿ç§»æ£€æŸ¥æ¸…å•

### æŠ€æœ¯å‡†å¤‡
- [ ] Monorepo ç¯å¢ƒæ­å»º
- [ ] å¾®å‰ç«¯ä¸»åº”ç”¨å®Œæˆ
- [ ] å…±äº«åº“å‡†å¤‡
- [ ] CI/CD é…ç½®

### ä¸šåŠ¡å‡†å¤‡
- [ ] æ¨¡å—åˆ’åˆ†å®Œæˆ
- [ ] API å…¼å®¹æ–¹æ¡ˆ
- [ ] æ•°æ®è¿ç§»æ–¹æ¡ˆ
- [ ] æƒé™æ˜ å°„æ–¹æ¡ˆ

### æµ‹è¯•å‡†å¤‡
- [ ] æµ‹è¯•ç¯å¢ƒæ­å»º
- [ ] æµ‹è¯•ç”¨ä¾‹å‡†å¤‡
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å›æ»šæ–¹æ¡ˆ

### ä¸Šçº¿å‡†å¤‡
- [ ] ç°åº¦å‘å¸ƒè®¡åˆ’
- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] åº”æ€¥é¢„æ¡ˆ
- [ ] å›¢é˜ŸåŸ¹è®­å®Œæˆ

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æœ€å°åŒ–é£é™©
- å…ˆæ¥å…¥éæ ¸å¿ƒæ¨¡å—
- å……åˆ†æµ‹è¯•åå†è¿ç§»æ ¸å¿ƒæ¨¡å—
- ä¿ç•™å›æ»šèƒ½åŠ›

### 2. ä¿æŒä¸šåŠ¡è¿ç»­æ€§
- ç°åº¦å‘å¸ƒ
- åŒå†™æ•°æ®
- åŠŸèƒ½å¼€å…³

### 3. å›¢é˜ŸåŸ¹è®­
- æå‰åŸ¹è®­æ–°æ¶æ„
- å»ºç«‹æŠ€æœ¯æ”¯æŒæœºåˆ¶
- å®šæœŸ code review

## ğŸ“Š è¿ç§»æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šä»å•ä½“åº”ç”¨åˆ°å¾®å‰ç«¯

**é¡¹ç›®èƒŒæ™¯**:
- Vue 2 å•ä½“åº”ç”¨
- 50+ é¡µé¢
- 5 ä¸ªä¸šåŠ¡åŸŸ

**è¿ç§»æ–¹æ¡ˆ**:
```
Week 1-2: æ­å»ºä¸»åº”ç”¨ï¼Œæ¥å…¥æ•´ä¸ªè€åº”ç”¨
Week 3-4: æ‹†åˆ†ç”¨æˆ·ç®¡ç†æ¨¡å—
Week 5-6: æ‹†åˆ†è®¢å•ç®¡ç†æ¨¡å—
Week 7-8: æ‹†åˆ†å…¶ä»–æ¨¡å—
Week 9-10: ä¼˜åŒ–å’Œæµ‹è¯•
Week 11-12: ç°åº¦å‘å¸ƒå’Œå…¨é‡åˆ‡æ¢
```

## ğŸš¨ é£é™©é¢„è­¦

### é«˜é£é™©é¡¹
- ğŸ”´ æ•°æ®åº“ç»“æ„å˜æ›´
- ğŸ”´ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘é‡æ„
- ğŸ”´ æƒé™ä½“ç³»æ”¹é€ 

### ä¸­é£é™©é¡¹
- ğŸŸ¡ ç¬¬ä¸‰æ–¹ä¾èµ–å‡çº§
- ğŸŸ¡ æ ·å¼é€‚é…
- ğŸŸ¡ æ€§èƒ½å›å½’

### ä½é£é™©é¡¹
- ğŸŸ¢ UI ä¼˜åŒ–
- ğŸŸ¢ ä»£ç è§„èŒƒè°ƒæ•´
- ğŸŸ¢ å·¥å…·é“¾å‡çº§

## ğŸ“š å‚è€ƒèµ„æ–™

- [å¾®å‰ç«¯å®æˆ˜](https://micro-frontends.org/)
- [qiankun å®˜æ–¹æ–‡æ¡£](https://qiankun.umijs.org/)
- [å¤§å‹é¡¹ç›®è¿ç§»æ¡ˆä¾‹](https://example.com)

---

**çŠ¶æ€**: âœ… å®Œæˆ  
**é¢„è®¡æ—¶é—´**: 4å°æ—¶

## ğŸ‰ æ–‡æ¡£ä½“ç³»å®Œæˆï¼

æ­å–œï¼æ‰€æœ‰å®æ–½æ–‡æ¡£å·²è¡¥å……å®Œæ•´ï¼Œå¯ä»¥å¼€å§‹å¾®å‰ç«¯é¡¹ç›®çš„å®Œæ•´å®æ–½äº†ï¼

