# BtcDoubleLayout 增强方案

## 需求分析

根据实际使用场景：
- **大部分页面**: 双栏布局（左右）
- **少数页面**: 三栏布局（左中右）
- **极少数页面**: 四栏布局（左中右，最后一栏是垂直分栏）

## 增强方案设计

### 方案：增强 btc-double-layout 支持多栏

**核心思路**: 
- 保持 `btc-double-layout` 的简洁性
- 通过 props 控制栏数（2栏、3栏、4栏）
- 复用现有的折叠逻辑
- 保持 API 简洁

### 增强后的 API 设计

```vue
<BtcDoubleLayout
  :columns="2"  // 2栏、3栏、4栏
  :left-width="300px"
  :middle-width="200px"  // 三栏时使用
  :right-width="250px"   // 三栏、四栏时使用
>
  <!-- 左侧 -->
  <template #left-header>左侧标题</template>
  <template #left>左侧内容</template>
  
  <!-- 中间（三栏、四栏时） -->
  <template #middle-header>中间标题</template>
  <template #middle>中间内容</template>
  
  <!-- 右侧 -->
  <template #right-header>右侧标题</template>
  <template #right>右侧内容</template>
  
  <!-- 第四栏（垂直分栏，四栏时） -->
  <template #fourth-header>第四栏标题</template>
  <template #fourth>第四栏内容</template>
</BtcDoubleLayout>
```

### 实现思路

1. **双栏模式**（columns=2，默认）
   - 保持现有实现
   - 左侧固定宽度，右侧自适应
   - 折叠时右侧覆盖左侧

2. **三栏模式**（columns=3）
   - 左侧固定宽度
   - 中间固定宽度
   - 右侧自适应
   - 折叠逻辑：可以折叠左侧或中间

3. **四栏模式**（columns=4）
   - 左侧固定宽度
   - 中间固定宽度
   - 右侧固定宽度
   - 第四栏：垂直分栏（在右侧内部）
   - 折叠逻辑：可以折叠左侧、中间或右侧

### 技术实现要点

1. **布局方式**:
   - 双栏：保持现有实现（固定宽度 + 绝对定位）
   - 三栏：左侧固定 + 中间固定 + 右侧绝对定位自适应
   - 四栏：左侧固定 + 中间固定 + 右侧固定 + 第四栏在右侧内部垂直分栏

2. **折叠逻辑**:
   - 双栏：折叠左侧，右侧覆盖
   - 三栏：可以折叠左侧或中间，右侧覆盖
   - 四栏：可以折叠左侧、中间或右侧

3. **宽度计算**:
   - 使用 computed 计算每个栏的宽度
   - 确保折叠时宽度变化平滑

## 优势分析

### ✅ 优势

1. **统一 API**: 所有场景使用同一个组件
2. **向后兼容**: 双栏模式保持现有 API 不变
3. **渐进增强**: 三栏、四栏作为扩展功能
4. **维护成本低**: 只需维护一个组件
5. **学习成本低**: API 简洁，易于理解

### ⚠️ 注意事项

1. **复杂度增加**: 需要处理多栏场景的布局逻辑
2. **测试成本**: 需要测试 2栏、3栏、4栏的所有场景
3. **性能影响**: 多栏场景可能比双栏复杂，但影响应该很小

## 迁移计划

### 阶段一：增强 btc-double-layout（1-2周）

1. **扩展 props**:
   - `columns`: 2 | 3 | 4（默认 2）
   - `middleWidth`: 中间栏宽度（三栏、四栏时）
   - `rightWidth`: 右侧栏宽度（四栏时）

2. **扩展插槽**:
   - `middle-header`: 中间栏头部
   - `middle`: 中间栏内容
   - `fourth-header`: 第四栏头部（四栏时）
   - `fourth`: 第四栏内容（四栏时）

3. **扩展折叠逻辑**:
   - 支持折叠左侧、中间或右侧
   - 保持折叠动画平滑

### 阶段二：迁移现有组件（2-3周）

1. **btc-filter-group** → `btc-double-layout`（双栏）
2. **btc-view-group** → `btc-double-layout`（双栏）
3. **btc-grid-group** → `btc-double-layout`（三栏）
4. **btc-double-group** → 保持现状（左侧双列，结构特殊）

### 阶段三：清理和优化（1周）

1. 移除临时布局代码
2. 更新文档
3. 完善测试

## 与 btc-splitter 的关系

### btc-splitter 的定位

**保留场景**:
- 需要**拖拽调整大小**的场景
- 需要**任意数量分栏**（5栏及以上）的场景
- 需要**复杂折叠控制**的场景

**不推荐场景**:
- 只需要简单的双栏、三栏、四栏布局
- 不需要拖拽调整大小
- 只需要简单的折叠功能

### 组件选择指南

| 场景 | 推荐组件 | 理由 |
|------|---------|------|
| 双栏，简单折叠 | `btc-double-layout` | 简单、轻量 |
| 三栏，简单折叠 | `btc-double-layout` | 增强后支持 |
| 四栏，简单折叠 | `btc-double-layout` | 增强后支持 |
| 需要拖拽调整 | `btc-splitter` | 唯一支持拖拽 |
| 5栏及以上 | `btc-splitter` | 更灵活 |
| 复杂折叠控制 | `btc-splitter` | 更强大 |

## 实施建议

### 🎯 推荐方案：增强 btc-double-layout

**理由**:
1. **符合实际需求**: 大部分场景只需要双栏、三栏、四栏
2. **统一维护**: 只需维护一个组件
3. **向后兼容**: 现有代码无需修改
4. **渐进增强**: 可以逐步支持多栏

**实施步骤**:
1. 先增强 `btc-double-layout` 支持三栏
2. 测试验证三栏功能
3. 再增强支持四栏（垂直分栏）
4. 迁移现有组件
5. 清理临时代码

## 总结

**最终方案**: **增强 btc-double-layout 支持多栏**

- ✅ 统一使用 `btc-double-layout` 处理 2栏、3栏、4栏场景
- ✅ 保留 `btc-splitter` 用于需要拖拽或5栏及以上的场景
- ✅ 保持 API 简洁，向后兼容
- ✅ 降低维护成本，提升代码质量
