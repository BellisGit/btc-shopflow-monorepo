# 双栏组件梳理报告

> 生成时间：2025-01-27
> 最后更新：2025-01-27
> 基于实际代码文件分析

## 一、基础布局组件

### 1. BtcDoubleLayout（双栏布局基础组件）

**文件路径**：`packages/shared-components/src/components/layout/btc-double-layout/index.vue`

**组件内部名**：`BtcDoubleLayout`

**导出名**：`BtcDoubleLayout`

**功能**：
- 基础的左右双栏布局组件
- 左侧固定宽度，右侧自适应
- 支持折叠/展开功能
- 折叠时右侧覆盖左侧

**使用场景**：
- 作为其他组合组件的基础布局
- 需要简单双栏布局的场景

**特点**：
- 轻量级实现
- API 简洁
- 参考 cool-admin 的 cl-view-group

---

### 2. BtcViews（多栏布局组件）

**文件路径**：`packages/shared-components/src/components/layout/btc-views/index.vue`

**组件内部名**：`BtcViews`

**导出名**：`BtcViews`

**功能**：
- 支持 2栏、3栏、4栏的布局组件
- 支持多栏折叠控制
- 第四栏支持垂直分栏（四栏模式）

**使用场景**：
- 需要多栏布局的场景（3栏及以上）
- 需要复杂折叠控制的场景

**特点**：
- 功能完整
- 支持复杂的折叠逻辑
- 使用单一状态源管理布局模式

---

## 二、组合组件（使用双栏布局）

### 3. BtcMasterTableGroup（主列表表格组）

**文件路径**：`packages/shared-components/src/components/data/btc-master-table-group/index.vue`

**组件内部名**：`BtcMasterTableGroup`

**导出名**：`BtcMasterTableGroup`

**使用的布局**：`BtcDoubleLayout`

**功能**：
- 左侧：`BtcMasterList`（主列表，支持树形/列表）
- 右侧：`BtcCrud`（完整的 CRUD 表格）
- 自动联动：左侧选择变化时，自动刷新右侧表格
- 参数自动传递：左侧选中项的 ID 自动传递给右侧查询

**使用场景**：
- 部门-用户管理
- 分类-商品管理
- 角色-权限管理
- 其他"左树右表"联动场景

**特点**：
- 开箱即用
- 自动处理参数传递
- 支持"未分配"选项
- 数据自动注入到表单级联选择器

---

### 4. BtcFilterTableGroup（筛选列表表格组）

**文件路径**：`packages/shared-components/src/components/data/btc-filter-table-group/index.vue`

**组件内部名**：`BtcFilterTableGroup`

**导出名**：`BtcFilterTableGroup`

**使用的布局**：`BtcDoubleLayout`

**功能**：
- 左侧：`BtcFilterList`（筛选列表，支持多分类筛选）
- 右侧：`BtcCrud`（完整的 CRUD 表格）
- 自动联动：筛选条件变化时，自动刷新右侧表格
- 列优先级：根据筛选结果自动调整表格列顺序

**使用场景**：
- 需要多维度筛选的表格场景
- 筛选条件会影响表格列的显示

**特点**：
- 支持动态宽度调整
- 支持列优先级排序
- 支持筛选搜索
- 支持清除所有筛选

---

## 三、导出情况分析

### 实际导出（index.ts）

```typescript
// 基础布局组件
export { default as BtcDoubleLayout } from './components/layout/btc-double-layout/index.vue';
export { default as BtcViews } from './components/layout/btc-views/index.vue';

// 组合组件
export { default as BtcMasterTableGroup } from './components/data/btc-master-table-group/index.vue';
export { default as BtcFilterTableGroup } from './components/data/btc-filter-table-group/index.vue';
```

### 类型定义导出（index.d.ts）

```typescript
// 基础布局组件
export { default as BtcDoubleLayout } from './components/layout/btc-double-layout/index.vue';
export { default as BtcViews } from './components/layout/btc-views/index.vue';

// 组合组件
export { default as BtcMasterTableGroup } from './components/data/btc-master-table-group/index.vue';
export { default as BtcFilterTableGroup } from './components/data/btc-filter-table-group/index.vue';

// 类型导出
export type { MasterTableGroupProps as BtcMasterTableGroupProps, ... } from './components/data/btc-master-table-group/types';
export type { BtcFilterTableGroupProps, ... } from './components/data/btc-filter-table-group/types';
```

### 已删除的导出

以下组件已从导出中移除（原因：不存在或为别名）：

1. **BtcMasterViewGroup** - 已删除别名导出（原为 `BtcDoubleLayout` 的别名）
2. **BtcGridGroup** - 已删除（文件不存在）
3. **BtcDoubleLeftGroup** - 已删除（文件不存在）

---

## 四、已修复的问题

### ✅ 问题 1：BtcMasterViewGroup 别名导出已删除

**问题描述**：
- `BtcMasterViewGroup` 原为 `BtcDoubleLayout` 的别名导出
- `index.ts` 和 `index.d.ts` 中路径不一致

**修复状态**：✅ 已修复
- 已从 `index.ts` 中删除 `BtcMasterViewGroup` 别名导出
- 已从 `index.d.ts` 中删除 `BtcMasterViewGroup` 导出
- 所有使用 `BtcMasterViewGroup` 的地方已改为使用 `BtcDoubleLayout`

---

### ✅ 问题 2：不存在的组件导出已删除

**问题描述**：
- `BtcGridGroup` 和 `BtcDoubleLeftGroup` 在类型定义中有导出，但实际文件不存在

**修复状态**：✅ 已修复
- 已从 `index.d.ts` 中删除 `BtcGridGroup` 导出和相关类型导出
- 已从 `index.d.ts` 中删除 `BtcDoubleLeftGroup` 导出和相关类型导出

**注意**：
- `BtcGridGroup` 在 `apps/admin-app/src/modules/strategy/views/designer/index.vue` 中被使用（已注释导入）
- 如需使用三栏布局，建议使用 `BtcViews`（columns=3）作为替代方案

---

## 五、组件关系图

```
基础布局组件
├── BtcDoubleLayout（双栏布局）
│   └── 被以下组件使用：
│       ├── BtcMasterTableGroup
│       └── BtcFilterTableGroup
│
└── BtcViews（多栏布局，支持2/3/4栏）
    └── 目前未被组合组件使用

组合组件
├── BtcMasterTableGroup
│   ├── 布局：BtcDoubleLayout
│   ├── 左侧：BtcMasterList
│   └── 右侧：BtcCrud
│
└── BtcFilterTableGroup
    ├── 布局：BtcDoubleLayout
    ├── 左侧：BtcFilterList
    └── 右侧：BtcCrud
```

---

## 六、命名规范总结

### ✅ 符合规范的组件

| 组件 | 内部名 | 导出名 | 文件路径 | 状态 |
|------|--------|--------|---------|------|
| BtcDoubleLayout | BtcDoubleLayout | BtcDoubleLayout | btc-double-layout | ✅ 一致 |
| BtcViews | BtcViews | BtcViews | btc-views | ✅ 一致 |
| BtcMasterTableGroup | BtcMasterTableGroup | BtcMasterTableGroup | btc-master-table-group | ✅ 一致 |
| BtcFilterTableGroup | BtcFilterTableGroup | BtcFilterTableGroup | btc-filter-table-group | ✅ 一致 |

### ✅ 已删除的导出

| 组件 | 状态 | 说明 |
|------|------|------|
| BtcMasterViewGroup | ✅ 已删除 | 原为 `BtcDoubleLayout` 的别名，已删除并改为使用 `BtcDoubleLayout` |
| BtcGridGroup | ✅ 已删除 | 文件不存在，已从导出中移除 |
| BtcDoubleLeftGroup | ✅ 已删除 | 文件不存在，已从导出中移除 |

---

## 七、使用建议

### 选择指南

1. **只需要简单双栏布局** → 使用 `BtcDoubleLayout`
2. **需要多栏布局（3栏及以上）** → 使用 `BtcViews`
3. **左树右表联动场景** → 使用 `BtcMasterTableGroup`
4. **需要多维度筛选的表格** → 使用 `BtcFilterTableGroup`

### 命名规范

- **基础布局组件**：使用功能名（如 `BtcDoubleLayout`、`BtcViews`）
- **组合组件**：使用 `Group` 后缀，左侧内容在前（如 `BtcMasterTableGroup`、`BtcFilterTableGroup`）

---

## 八、修复历史

1. ✅ 已修复：`BtcTableGroup` → `BtcMasterTableGroup`（类型定义和文档）
2. ✅ 已修复：删除 `BtcMasterViewGroup` 别名导出
   - 已从 `index.ts` 和 `index.d.ts` 中删除
   - 所有使用处已改为 `BtcDoubleLayout`
3. ✅ 已修复：删除 `BtcGridGroup` 和 `BtcDoubleLeftGroup` 导出
   - 已从 `index.d.ts` 中删除不存在的组件导出
   - 相关类型导出也已删除

## 九、实际存在的双栏组件

### 基础布局组件（2个）

1. **BtcDoubleLayout** - 双栏布局基础组件
   - 文件路径：`components/layout/btc-double-layout/index.vue`
   - 功能：基础的左右双栏布局，支持折叠/展开

2. **BtcViews** - 多栏布局组件（支持2/3/4栏）
   - 文件路径：`components/layout/btc-views/index.vue`
   - 功能：支持2栏、3栏、4栏的布局，支持复杂的折叠控制

### 组合组件（2个）

1. **BtcMasterTableGroup** - 主列表表格组
   - 文件路径：`components/data/btc-master-table-group/index.vue`
   - 布局：使用 `BtcDoubleLayout`
   - 功能：左侧 MasterList + 右侧 CRUD 表格

2. **BtcFilterTableGroup** - 筛选列表表格组
   - 文件路径：`components/data/btc-filter-table-group/index.vue`
   - 布局：使用 `BtcDoubleLayout`
   - 功能：左侧 FilterList + 右侧 CRUD 表格

**总计：4个实际组件，4个导出**

---

## 十、迁移指南

### 从 BtcMasterViewGroup 迁移到 BtcDoubleLayout

**原代码**：
```vue
<BtcMasterViewGroup
  ref="viewGroupRef"
  left-width="280px"
  left-title="标题"
>
  <template #left>...</template>
  <template #right>...</template>
</BtcMasterViewGroup>
```

**新代码**：
```vue
<BtcDoubleLayout
  ref="viewGroupRef"
  left-width="280px"
  left-title="标题"
>
  <template #left>...</template>
  <template #right>...</template>
</BtcDoubleLayout>
```

**注意事项**：
- 如果原代码使用了 `left-service` 等 `BtcMasterTableGroup` 的属性，需要改为使用 `BtcMasterTableGroup` 组件
- 或者手动在左侧添加 `BtcMasterList` 组件
